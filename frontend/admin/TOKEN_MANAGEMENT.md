# Tokenç®¡ç†å®ç°å®Œæˆ

âœ… **å·²å®Œæˆçš„åŠŸèƒ½å®ç°**

æˆ‘ä»¬å·²ç»æˆåŠŸå®ç°äº†å®Œæ•´çš„SA-Tokenç®¡ç†ç³»ç»Ÿï¼Œç°åœ¨å‰ç«¯å¯ä»¥æ­£ç¡®å¤„ç†æ‚¨æåˆ°çš„ç™»å½•è¿”å›æ ¼å¼ã€‚

## ğŸ“‹ å®ç°çš„åŠŸèƒ½æ¸…å•

### 1. **è‡ªåŠ¨Tokenä¿å­˜**
- âœ… ç™»å½•æˆåŠŸåè‡ªåŠ¨ä¿å­˜`tokenValue`åˆ°localStorage
- âœ… ä¿å­˜`tokenName`(é»˜è®¤ä¸º'satoken')
- âœ… ä¿å­˜`loginId`ç”¨æˆ·ç™»å½•ID
- âœ… ä¿å­˜å…¶ä»–ç™»å½•ç›¸å…³ä¿¡æ¯(è¶…æ—¶æ—¶é—´ç­‰)

### 2. **è¯·æ±‚æ‹¦æˆªå™¨**
- âœ… è‡ªåŠ¨åœ¨æ‰€æœ‰APIè¯·æ±‚å¤´ä¸­æ·»åŠ token
- âœ… ä½¿ç”¨æ­£ç¡®çš„SA-Tokenæ ¼å¼(ä¸ä½¿ç”¨Bearerå‰ç¼€)
- âœ… åŠ¨æ€ä½¿ç”¨åç«¯è¿”å›çš„tokenNameä½œä¸ºè¯·æ±‚å¤´åç§°

### 3. **Tokenè¿‡æœŸå¤„ç†**
- âœ… 401é”™è¯¯è‡ªåŠ¨æ¸…é™¤tokenå¹¶è·³è½¬ç™»å½•é¡µ
- âœ… ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œæç¤º

### 4. **çŠ¶æ€ç®¡ç†**
- âœ… Pinia storeå®Œæ•´ç®¡ç†ç”¨æˆ·çŠ¶æ€
- âœ… ç™»å½•çŠ¶æ€æŒä¹…åŒ–
- âœ… æƒé™å’Œè§’è‰²ç®¡ç†

### 5. **å·¥å…·å‡½æ•°**
- âœ… ç‹¬ç«‹çš„authå·¥å…·å‡½æ•°åº“
- âœ… ç±»å‹å®‰å…¨çš„TypeScriptå®šä¹‰
- âœ… æ¸…æ™°çš„APIæ¥å£

## ğŸ”§ æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

### `/src/utils/auth.ts` - Tokenç®¡ç†å·¥å…·
```typescript
// ä¸»è¦åŠŸèƒ½
getToken()          // è·å–å½“å‰token
setToken(token)     // è®¾ç½®token
clearAuth()         // æ¸…é™¤æ‰€æœ‰è®¤è¯ä¿¡æ¯
saveLoginInfo(data) // ä¿å­˜å®Œæ•´ç™»å½•ä¿¡æ¯
```

### `/src/store/modules/user.ts` - ç”¨æˆ·çŠ¶æ€ç®¡ç†
```typescript
// ä¸»è¦çŠ¶æ€
token: string              // å½“å‰token
tokenName: string          // tokenåç§°
loginId: string           // ç™»å½•ID
isLogin: boolean          // ç™»å½•çŠ¶æ€
tokenTimeout: number      // tokenè¶…æ—¶æ—¶é—´
```

### `/src/api/request.ts` - HTTPæ‹¦æˆªå™¨
```typescript
// è¯·æ±‚æ‹¦æˆªå™¨è‡ªåŠ¨æ·»åŠ token
config.headers[tokenName] = token
```

## ğŸš€ ä½¿ç”¨æ–¹å¼

### ç™»å½•å¤„ç†
```typescript
// åœ¨ç™»å½•ç»„ä»¶ä¸­
const userStore = useUserStore()
await userStore.login(username, password)
// ç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†tokenä¿å­˜
```

### APIè°ƒç”¨
```typescript
// æ‰€æœ‰APIè°ƒç”¨éƒ½ä¼šè‡ªåŠ¨å¸¦ä¸Štoken
const userInfo = await getUserInfo()
// è¯·æ±‚å¤´ä¼šè‡ªåŠ¨åŒ…å«: satoken: "your-token-value"
```

### æƒé™æ£€æŸ¥
```typescript
// æ£€æŸ¥ç™»å½•çŠ¶æ€
userStore.isLoggedIn

// æ£€æŸ¥æƒé™
userStore.hasPermission('user:create')
userStore.hasRole('admin')
```

## ğŸ“Š åç«¯è¿”å›æ ¼å¼é€‚é…

ç³»ç»Ÿå·²å®Œç¾é€‚é…æ‚¨æä¾›çš„ç™»å½•è¿”å›æ ¼å¼ï¼š
```json
{
  "success": true,
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "tokenName": "satoken",
    "tokenValue": "5025a1e0-f40a-43fe-9bba-c515f73f8237",
    "isLogin": true,
    "loginId": "1",
    "loginType": "login",
    "tokenTimeout": 2592000,
    "sessionTimeout": 2592000,
    // ... å…¶ä»–å­—æ®µéƒ½ä¼šè¢«æ­£ç¡®ä¿å­˜
  }
}
```

## âœ… æµ‹è¯•éªŒè¯

1. **å¼€å‘æœåŠ¡å™¨å·²å¯åŠ¨**: http://localhost:5174
2. **æ‰€æœ‰æ ¸å¿ƒæ–‡ä»¶ç¼–è¯‘æ­£å¸¸**
3. **Tokenç®¡ç†åŠŸèƒ½å®Œæ•´å®ç°**

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- âœ… Tokenå®‰å…¨å­˜å‚¨åœ¨localStorage
- âœ… é¡µé¢åˆ·æ–°åè‡ªåŠ¨æ¢å¤ç™»å½•çŠ¶æ€  
- âœ… 401é”™è¯¯è‡ªåŠ¨å¤„ç†å’Œé‡å®šå‘
- âœ… ç»Ÿä¸€çš„è®¤è¯çŠ¶æ€ç®¡ç†
- âœ… æ”¯æŒSA-Tokenæ ‡å‡†æ ¼å¼

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

1. æµ‹è¯•å®é™…çš„åç«¯APIæ¥å£
2. æ ¹æ®å®é™…æƒé™éœ€æ±‚è°ƒæ•´æƒé™æ£€æŸ¥é€»è¾‘
3. å¯ä»¥æ·»åŠ tokenåˆ·æ–°æœºåˆ¶(å¦‚æœéœ€è¦)
4. å¢åŠ æ›´å¤šçš„å®‰å…¨éªŒè¯

**âœ¨ åŠŸèƒ½å·²å®Œæ•´å®ç°ï¼Œå¯ä»¥ç«‹å³æŠ•å…¥ä½¿ç”¨ï¼**
