# Dreamy Hive 项目 TODO List

本文档根据 `dreamy hive开发文档.md` 整理，用于追踪项目开发进度。

## 一、功能模块 TODO

### 模块一：用户端（User）

- [ ] **商品浏览**：展示商品列表，支持按分类、关键词搜索
- [ ] **商品详情**：查看商品主图、轮播图、描述、价格、库存等信息
- [ ] **SKU 支持**：同一商品支持多个规格（如颜色、尺寸）
- [x] **购物车**：用户可添加商品到购物车，修改数量或删除
- [x] **下单支付**：简化版下单流程，模拟付款成功即可生成订单
- [x] **订单中心**：展示用户的订单历史（状态如待发货、已发货、已完成）
- [x] **社区模块**：浏览/发布帖子、评论、点赞

### 模块二：管理端（Admin）

- [x] **登录模块**：使用已有用户登录，判断 role 决定权限（已通过Sa-Token实现）
- [x] **商品管理**：新增/编辑/删除商品，上传多图，管理 SKU
- [x] **分类管理**：添加/修改/删除商品分类
- [x] **SKU 管理**：为商品添加规格（如颜色、尺寸）
- [x] **图片管理**：查看并上传商品相关图片
- [x] **订单管理**：查看订单详情、发货、取消等操作
- [x] **帖子管理**：审核/删除用户发布的帖子
- [ ] **用户管理（可选）**：查看用户列表、修改角色（进阶）

---

## 二、开发阶段 TODO

根据建议的开发流程，将任务分解如下：

- [x] **第一阶段：基础环境搭建**
    - [x] 搭建 Spring Boot 项目
    - [x] 集成 MyBatis / MyBatis Plus
    - [x] 配置 MySQL 数据库连接
    - [x] 引入 Lombok 等基础依赖

- [x] **第二阶段：核心商品模块（用户端）**
    - [x] 商品分类展示
    - [x] 商品列表展示（支持分页、分类筛选、关键词搜索）
    - [x] 商品详情页（SPU信息、SKU列表、图片轮播、描述）
    - [x] SKU 规格选择逻辑
    - [x] 多图片上传与管理（针对商品）

- [x] **第三阶段：核心社区模块（用户端）**
    - [x] 帖子列表展示（瀑布流或列表）
    - [x] 帖子详情页
    - [x] 用户发布新帖子（含图片上传）
    - [x] 用户评论帖子
    - [x] 用户点赞帖子

- [x] **第四阶段：购物车与下单流程（用户端）**
    - [x] 添加商品到购物车
    - [x] 查看购物车列表
    - [x] 修改购物车商品数量/删除商品
    - [x] 简化版下单流程（选择地址、确认商品）
    - [x] 模拟支付成功，生成订单
    - [x] 用户订单中心（订单列表、订单详情、订单状态）

- [x] **第五阶段：管理端 - 商品相关管理**
    - [x] 管理员登录逻辑（基于用户表的 role 字段）
    - [x] 商品管理（SPU的增删改查、上下架）
    - [x] 商品分类管理（增删改查）
    - [x] SKU 管理（为SPU添加/编辑/删除SKU）
    - [x] 商品图片管理（关联SPU/SKU）

- [x] **第六阶段：管理端 - 订单与社区管理**
    - [x] 订单管理（查看订单列表、订单详情、修改订单状态如发货）
    - [x] 帖子管理（查看帖子列表、审核/删除帖子）

- [ ] **第七阶段：前后端整合与测试**
    - [ ] Vue 前端页面搭建（用户端和管理端）
    - [ ] 前后端接口对接联调
    - [ ] 整体功能测试与 Bug 修复

---

## 三、技术实现与改进记录

### 1. 认证与权限管理
- [x] **Sa-Token 集成**：已集成Sa-Token实现用户认证和权限管理
- [x] **@CurrentUser 注解**：实现了自定义的`@CurrentUser`注解，用于在控制器方法中自动注入当前登录用户ID
- [x] **角色权限控制**：通过Sa-Token的路由拦截器实现了基于角色的访问控制，如`/api/admin/**`路径需要admin角色

### 2. 购物车与订单系统
- [x] **购物车功能**：实现了购物车的添加、修改、删除、选择等功能
- [x] **地址管理**：实现了收货地址的增删改查和设置默认地址功能
- [x] **订单流程**：实现了订单创建、支付、发货、确认收货、取消等完整流程
- [x] **订单管理**：实现了管理员查看订单、发货、取消订单等功能

### 3. 商品管理系统
- [x] **分类管理**：完成了商品分类的CRUD操作，支持多级分类
- [x] **产品管理**：实现了SPU的增删改查、上下架功能
- [x] **SKU管理**：实现了SKU的属性管理、库存管理
- [x] **图片管理**：支持商品主图和详情图的上传与管理

---

**注意**：以上 TODO 列表可根据实际开发进度和需求调整。

# SKU 管理 UI 任务清单

## sku/index.vue 开发任务

- [ ] **完成 API 集成**
  - [ ] 确保所有 CRUD 操作都使用 product.ts 中正确的 API 函数
    - [ ] 使用 addSku API 添加新 SKU
    - [ ] 使用 updateSku API 更新现有 SKU
    - [ ] 使用 deleteSku API 删除 SKU
  
- [ ] **属性/规格 JSON 格式处理**
  - [ ] 开发将 SKU 属性转换为后端所需的 JSON 字符串格式 (spData) 的方法
  - [ ] 开发从 JSON 字符串格式转换为前端可用格式的方法
  
- [ ] **SKU 图片上传功能**
  - [ ] 集成 uploadProductImage 服务，用于上传特定 SKU 的图片
  - [ ] 实现图片预览和删除功能
  
- [ ] **SKU 状态更新**
  - [ ] 最终确定 SKU 状态（上架/下架）的更新方式
  - [ ] 实现状态切换功能及视觉反馈
  
- [ ] **SPU 上下文处理**
  - [ ] 确保页面能够处理未提供 SPU ID 的情况
  - [ ] 添加用户提示，引导用户选择 SPU

## ProductForm.vue 高级保存逻辑

- [ ] **属性值保存**
  - [ ] 实现产品属性值的实际保存逻辑
  - [ ] 与后端协调，确保 SPU DTO 能够正确存储这些数据
  
- [ ] **图像关联**
  - [ ] 明确在保存产品时如何将上传的图像正式关联到 SPU
  - [ ] 根据需要实现 associateSpuImages 或 setSpuMainImage API 调用

## 通用 UI/UX 增强（管理面板）

- [ ] **全面的错误处理**
  - [ ] 超越默认弹出窗口，实现更多上下文相关的错误消息
  - [ ] 增强表单验证失败时的视觉反馈
  
- [ ] **一致的加载状态**
  - [ ] 确保所有表格、表单和对话框在异步操作期间均显示清晰的加载指示
  
- [ ] **空状态处理**
  - [ ] 当表格和列表为空时，添加"未找到数据"或类似提示信息
  
- [ ] **仪表板完善**
  - [ ] 使用动态数据填充"最近订单"区域
  - [ ] 使用动态数据填充"热门产品"区域
  - [ ] 实现图表占位符的实际数据展示（可能需要新的专用 API 端点）

## 测试与改进

- [ ] **全面测试**
  - [ ] 对所有已实现的功能进行手动测试
  - [ ] 编写单元测试和集成测试（如适用）
  
- [ ] **代码审查**
  - [ ] 检查代码一致性
  - [ ] 识别并修复潜在错误
  - [ ] 寻找代码重构的机会

## 后端协调事项

- [ ] **产品属性和图片关联**
  - [ ] 与后端开发人员讨论产品属性在 SPU DTO 中的结构
  - [ ] 确保前端和后端在图片关联处理上保持一致
  
- [ ] **社区内容管理**
  - [ ] 明确社区帖子/评论被拒绝的原因/提交方式
  
- [ ] **SKU 状态更新机制**
  - [ ] 确认处理 SKU 状态更新的首选方式（通过常规更新或专用 API）